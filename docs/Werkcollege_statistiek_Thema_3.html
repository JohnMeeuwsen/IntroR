<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Werkcollege statistiek Thema 3</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="COO1.html">COO1</a>
</li>
<li>
  <a href="COO2.html">COO2</a>
</li>
<li>
  <a href="COO3.html">COO3</a>
</li>
<li>
  <a href="COO4.html">COO4</a>
</li>
<li>
  <a href="Werkcollege_statistiek_Thema_1.html">Statistiek 1</a>
</li>
<li>
  <a href="Werkcollege_statistiek_Thema_2.html">Statistiek 2</a>
</li>
<li>
  <a href="Werkcollege_statistiek_Thema_3.html">Statistiek 3</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Werkcollege statistiek Thema 3</h1>

</div>


<p>In het zelfstudie document is aan de hand van twee datasets een
aantal toetsen behandeld: de z-toets, de t-toets en de chi-kwadraat
toets. In dit COO komen deze toetsen opnieuw aan de orde, waarbij je
gebruik maakt van dezelfde datasets.</p>
<p>In dit COO maken we gebruik van een aantal packages en functies in R.
Voor het inlezen van bestanden en voor de beschrijvende statistiek zijn
deze al geïntroduceerd in de COO’s over R. We verwijzen je naar deze
COO’s wanneer je niet meer goed weet hoe deze functies werken. Voor de
toetsen staat het benodigde R script in de betreffende vraag.</p>
<div id="vraag-1-spirometrie-data." class="section level2">
<h2>Vraag 1 Spirometrie data.</h2>
<p>Je gaat de stappen behandeld in het zelfstudie document nu zelf
uitvoeren in R.</p>
<p>Hiervoor lees je de spirometrie data (<code>'spirometrie.csv'</code>)
allereerst in R in. Zorg er voor dat je het bestand van BB hebt gehaald
en lokaal hebt bewaard.</p>
<p>We beginnen met het inlezen van het bestand en dat bekijken. (<em>NB:
niet vergeten om de naam van de map, hier <code>mypath</code> genoemd,
te veranderen in de map waar jij het bestand heb opgeslagen!</em>) De
data staat in een .csv bestand <code>spirometrie.csv</code>. We lezen de
data in en noemen de data frame d (NB: niet vergeten om de naam van de
map, hier <code>mypath</code> genoemd, te veranderen in de map waar jij
het bestand heb opgeslagen).</p>
<pre class="r"><code>mypath &lt;- &quot;Werkcollege_statistiek_Thema_3&quot;
d &lt;- data.frame(read.csv2(file.path(mypath, &quot;spirometrie.csv&quot;)))
head(d)</code></pre>
<pre><code>##   Student Geslacht Leeftijd Lengte Gewicht Teugvolume  ERV  IRV  FVC FEV1
## 1       1        V       19    174      63       1.14 0.70 1.41 3.03 3.04
## 2       2        V       19    175      67       1.10 1.22 1.92 4.22 2.49
## 3       3        M       21    176      60       1.31 2.09 2.10 5.02 4.58
## 4       4        V       21    178      63       1.23 2.17 1.51 4.81 3.95
## 5       5        M       20    196      93       0.65 2.21 3.22 6.20 5.79
## 6       6        V       21    172      78         NA 1.65 1.51 4.36 3.91</code></pre>
<p>Om te beginnen, zijn de data in een boxplot weergegeven. Hierin is
een onderscheid gemaakt tussen mannen en vrouwen. <strong>Geef de FEV1
in een dergelijk boxplot weer. Bereken ook de beschrijvende statistieken
voor mannen en vrouwen (gemiddelde en standaard deviatie) in
R.</strong></p>
<pre><code>  Quanjer (1993)

  Referentiewaarden
  Vrouwen:  verwachte FEV1 = 3.95H – 0.025A – 2.60
  Mannen:   verwachte FEV1 = 4.30H – 0.029A – 2.49

  H = lengte in meters, A = leeftijd in jaren</code></pre>
<p><strong>Bereken op basis van de formules van Quanjer (1993) de
verwachte FEV1 voor ieder van de studenten in je databestand.</strong>
Let op: de lengte in het databestand is in centimeters, de formule van
Quanjer gebruikt lengte in meters. <strong>Bereken vervolgens het
verschil tussen de geobserveerde FEV1 en de verwachte FEV1.</strong></p>
<p><strong>Aan de hand van de gevonden verschillen, toets je of de FEV1
van studenten overeenkomt met de algemene populatie in
Nederland.</strong> In eerste instantie mag je veronderstellen dat de
standaard deviatie van de populatie bekend is, en wel gelijk aan
<code>0.5</code>. Verder ga je er vanuit dat de data normaal verdeeld
zijn. Je wil <span class="math inline">\(H_0:\mu = 0\)</span> en <span
class="math inline">\(H_1:\mu \neq 0\)</span> toetsen.</p>
<p>In R is er in de package <code>BSDA</code> een z-toets beschikbaar.
Wil je de z-waarde uitrekenen in R, dan gaat dit als volgt. Voor de
mannen:</p>
<pre class="r"><code>library(BSDA)

z.test(d$verschil[d$Geslacht == &quot;M&quot;],
       sigma.x = 0.5,
       alternative = &quot;two.sided&quot;,
       mu = 0,
       conf.level = 0.95)</code></pre>
<p>Default in R is de waarde voor <span
class="math inline">\(\mu\)</span> gelijk aan <code>0</code>. Ook
default wordt er een tweezijdig 95%-betrouwbaarheidsinterval geschat.
Dus <code>mu = 0, alternative = c("two.sided"), conf.level = 0.95</code>
is in het R script niet nodig om de toets te laten uitvoeren, maar is nu
voor de volledigheid wel vermeld.</p>
<p><strong>Maak de boxplots en histogrammen waarmee je kunt beoordelen
in hoeverre je voldoet aan de aanname van normaliteit.</strong> Houd
hierbij rekening met mogelijke verschillen in geslacht. Naast deze
plots, is het gebruikelijk om een ‘normal probability plot’ te gebruiken
voor het beoordelen van normaliteit van de data. Deze plot is al
geïntroduceerd in Oog voor Impact (voor opfrissen: (zie PSLS hoofdstuk
11, paragraaf ‘Normal quantile plots’ en <a
href="https://umcutrecht.mediamission.nl/Mediasite/Play/0e2109843156409ca053a07af8cca2e91d">https://umcutrecht.mediamission.nl/Mediasite/Play/0e2109843156409ca053a07af8cca2e91d</a>).
Maak ook een normal probability plot voor de FEV1 uitgesplitst naar
geslacht.</p>
<p><strong>Voer, zowel voor de mannen als voor de vrouwen afzonderlijk,
een z-toets uit. Interpreteer je gevonden resultaat.</strong></p>
<p><strong>Voer tenslotte een t-toets uit voor zowel mannen als
vrouwen.</strong> De t-toets is onderdeel van de basis van R, je hebt
hier geen aparte package voor nodig. Voor de mannen ziet het script er
als volgt uit:</p>
<pre class="r"><code>t.test(d$verschil[d$Geslacht == &quot;M&quot;],
       mu = 0,
       alternative = &quot;two.sided&quot;,
       conf.level = 0.95)</code></pre>
<p>Ook nu zijn de defaults <code>mu = 0</code>,
<code>alternative = "two.sided"</code> en
<code>conf.level = 0.95</code>. <strong>Verandert je conclusie ten
aanzien van de nulhypothese voor mannen en vrouwen nu je een t-toets
gebruikt? En als je conclusie verandert, kun je dan aangeven welke
parameter hiervoor verantwoordelijk is?</strong></p>
<p>In het databestand spirometrie staan ook de variabelen lengte en
gewicht. Bereken de BMI (gewicht [in kg])/(lengte [in m])<span
class="math inline">\(^2\)</span>. De gemiddelde BMI voor volwassen
mannen is in Nederland <code>26.9</code> en voor volwassen vrouwen
<code>26.6</code>. Toets of de studenten gemiddeld genomen een lagere
BMI hebben dan de gemiddelde Nederlandse BMI. Houd hierbij rekening met
de variabele <code>Geslacht</code>. Gebruik het stappenplan voor
toetsen.</p>
</div>
<div id="vraag-2-sars-cov-2-en-bloedgroep-data" class="section level2">
<h2>Vraag 2 SARS-CoV-2 en bloedgroep data</h2>
<p>Ook met deze dataset ga je de analyse in R uitvoeren. We gebruiken
hiervoor de oorspronkelijke dataset uit het artikel. Maak deze zelf in R
met behulp van onderstaande code: <strong>Maak de dataset in
R.</strong></p>
<pre class="r"><code>d &lt;- matrix(c(398, 25, 65, 462, 377, 36, 71, 291), 4)
rownames(d) &lt;- c(&quot;A&quot;, &quot;AB&quot;, &quot;B&quot;, &quot;O&quot;)
colnames(d) &lt;- c(&quot;cases&quot;, &quot;controls&quot;)</code></pre>
<p>Om R de matrix als een frequentie tabel te laten zien, is er nog een
extra stap nodig: gebruik hiervoor de functie as.table().</p>
<pre class="r"><code>dtab &lt;- as.table(d)
dtab</code></pre>
<pre><code>##    cases controls
## A    398      377
## AB    25       36
## B     65       71
## O    462      291</code></pre>
<p>Voor de interpretatie van de studie is het inzichtelijker om de
frequenties niet als absolute, maar als relatieve (of procentuele)
frequenties weer te geven. <strong>Maak een tabel met relatieve
frequenties.</strong> Hiervoor gebruik je de functie
<code>prop.table()</code>: <code>prop.table(dtab)</code>. Je kunt nog
een <code>1</code> of <code>2</code> toevoegen aan de functie:
<code>prop.table(dtab,1)</code> of <code>prop.table(dtab,2)</code>.
<strong>Welke informatie je krijgt met de verschillende relatieve
frequenties die je kunt berekenen? Welke relatieve frequenties hebben
jouw voorkeur bij de interpretatie?</strong></p>
<p><strong>Voer een chi-kwadraat toets uit op de data:</strong></p>
<pre class="r"><code>dtest &lt;- chisq.test(dtab)
dtest</code></pre>
<p><strong>Welke hypothese heb je nu getoetst? Geef ook de frequenties
die je onder de nulhypothese verwacht. Interpreteer je gevonden
resultaat (betrek hierbij ook de verwachte waardes).</strong></p>
</div>
<div id="vraag-3-progeria" class="section level2">
<h2>Vraag 3 Progeria</h2>
<p>Bij een kind met de genetische aandoening Progeria wordt het lichaam
snel ouder. Een groot deel van de kinderen met Progeria overlijdt jong,
in de tienerjaren, aan cardiovasculaire aandoeningen. In een klinische
studie wordt een aantal fysiologische variabelen, waaronder de
polsgolfsnelheid (PWV, Pulse Wave Velocity), onderzocht. De PWV wordt
vaak gebruikt als maat voor de vasculaire stijfheid, welke samenhangt
met de cardiovasculaire gezondheid van een individu. Wanneer de PWV
boven de <code>6.6</code> m/s komt, spreekt men van een abnormaal hoge
PWV. De onderzoekers vragen zich af of bij kinderen met Progeria deze
PWV waarde ook abnormaal hoog is. De onderzoekers hebben de volgende PWV
waarden gevonden:</p>
<pre><code>## 18.8 17.6 17.5 16 17.8 14.1 13.7 13.1 12.9 12.9 12.4 10.1 9.3 9.1 8.3 8.3 7.9 7.2</code></pre>
<p><strong>Doorloop het 4-stappenplan voor toetsen. Voer de analyse uit
in R.</strong></p>
<p><strong>Veel programma’s geven niet de mogelijkheid om aan te geven
of je één- of tweezijdig toetst: de berekeningen zijn dan gebaseerd op
een tweezijdige toets.</strong></p>
<pre class="r"><code>t.test(d, mu = 6.6, conf.level = 0.95)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  d
## t = 6.6825, df = 17, p-value = 3.855e-06
## alternative hypothesis: true mean is not equal to 6.6
## 95 percent confidence interval:
##  10.71328 14.50894
## sample estimates:
## mean of x 
##  12.61111</code></pre>
<p><strong>Hoe kun je met dergelijke output dan toch éénzijdig
toetsen?</strong></p>
</div>
<div id="vraag-4-paracetamol" class="section level2">
<h2>Vraag 4 Paracetamol</h2>
<p>In een paracetamol tablet zit – volgens de verpakking – 500 mg
paracetamol. Deze hoeveelheid paracetamol is een variabele, dat wil
zeggen, in een tablet zal nooit exact 500 mg paracetamol zitten. De
vraag is nu of de fabrikant van de tabletten doet wat er wordt beloofd.
Is de hoeveelheid paracetamol in een steekproef van tabletten gelijk aan
500 mg? In het bestand <code>paracetamol.csv</code> vind je metingen van
een practicum van een eerder studiejaar. Er zijn twee metingen met UV en
twee metingen met HPLC uitgevoerd. Als uitkomstvariabelen gebruik je het
gemiddelde van de twee UV metingen.</p>
<p><strong>Doorloop het 4-stappenplan voor toetsen voor deze dataset.
Voer de analyse uit in R.</strong></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
